<?xml version="1.0" encoding="UTF-8" ?>
<html xmlns="http://www.w3.org/1999/html">


<head>

<meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <script src="http://fenixapps.fao.org/repository/js/jquery/1.8.3/jquery.min.js"></script>


    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <link rel='stylesheet' href='http://fenixapps.fao.org/maps/libs/leaflet/0.5.1/leaflet.css' /><!--[if lte IE 8]><link rel='stylesheet' href='http://fenixapps.fao.org/maps/libs/leaflet/0.5.1/leaflet.ie.css' /><![endif]-->


    <style>body {padding: 0;margin: 0;} 	html, body,#mainSplitter {width: 600; height: 600; }  #map3 {width: 300; height: 300; } #map {width: 300; height: 300; } #map2 {width: 300; height: 300; }</style><link rel='stylesheet' href='http://fenixapps.fao.org/maps/libs/leaflet/0.5.1/legend.css' /><!--[if lte IE 8]><link rel='stylesheet' href=http://fenixapps.fao.org/maps/libs/leaflet/0.5.1/legend.ie.css' /><![endif]--></head>

    <script src="http://fenixapps.fao.org/maps/libs/leaflet/0.5.1/leaflet.js" type="text/javascript"></script>

<script>
function test() {

    var map2;
    var map;

    var gaul0_line = new L.TileLayer.WMS('http://localhost:9090/geoserver/wms',
            {layers:"fenix:gaul0_line",
                format:"image/png",
                styles:"gaul0_line",
                visibility:true,
                transparent:true});

    var map2 = new L.Map('map2', {minZoom: 1});map2.setView(new L.LatLng(0.0, 0.0), 1); map2.addControl(new L.Control.Scale()); var layer52320 = new L.TileLayer('http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png');map2.addLayer(layer52320);var layer22000 = new L.TileLayer('http://otile1.mqcdn.com/tiles/1.0.0/osm/{z}/{x}/{y}.png');var baseMapsmap2 = {"Open Street Map": layer52320, "Map Quest": layer22000};var overlayMapsmap2 = {};var control_map2 = L.control.layers(baseMapsmap2, overlayMapsmap2).addTo(map2);

    var gaul0_line2 = new L.TileLayer.WMS('http://localhost:9090/geoserver/wms',
            {layers:"fenix:gaul0_line",
                format:"image/png",
                styles:"gaul0_line",
                visibility:true,
                transparent:true});

    // AJAX call to the map service
    $.ajax({
        type: 'GET',
       // url: 'http://localhost:8080/maps/api?out=js',
        url: 'http://localhost:8080/maps/api?out=js&baselayers=osm,mapquest',
        success : function(response) {
            //console.log(response);
           // response = response.substring(3, response.length -1);
            eval( response);

            	$.ajax({
                     type: 'GET',
                     //url: 'http://fenix.fao.org/maps/api?out=js&baselayers=osm&layers=gaul0_faostat_3857,gaul0_line_3857&styles=join,gaul0_line&joinboundary=FAOSTAT&enablejoingfi=true&joindata=[(1,326177.242),(2,3879424.421),(3,558745.842),(4,2907058.684),(7,626707.263),(8,63.526),(9,3.3887636632E7),(10,3.0836252632E7),(11,4854629.474),(12,359.105),(14,581.263),(15,2351409.875),(16,3.7433493632E7),(18,148115.053),(19,1401834.0),(20,40200.684),(21,5.5580661053E7),(23,55240.368),(25,2333.105),(26,639.105),(27,5734233.263),(28,2.4249129947E7),(29,279688.105),(32,1665080.789),(33,4.9452055263E7),(35,10676.368),(37,176496.263),(38,2999787.579),(39,1387452.316),(40,3102757.342),(44,3915914.632),(45,22961.526),(46,16621.579),(48,238714.316),(49,738111.316),(50,105167.316),(51,1.0197892E7),(52,1654203.316),(53,973346.842),(54,8886018.789),(55,225.474),(56,629513.477),(57,6013286.158),(58,2086055.263),(59,1.9233191053E7),(60,863322.737),(62,5034885.0),(63,644858.421),(66,15886.895),(67,3602510.526),(68,6.2986557E7),(69,21080.316),(72,10.895),(73,548516.842),(74,30912.632),(75,172405.105),(79,4.3487323368E7),(80,1132106.684),(81,1890353.684),(84,4849434.158),(86,346.0),(88,30.421),(89,1301484.105),(90,1897850.263),(91,485457.421),(93,437159.263),(95,646502.053),(97,1.2468378158E7),(98,2992673.263),(100,2.32463710526E8),(101,6.4094251053E7),(102,1.8231554737E7),(103,2894529.263),(104,2030628.842),(105,250737.895),(106,2.0224823158E7),(107,1329017.0),(108,1.5281391E7),(109,2575.637),(110,1.2269366842E7),(112,82415.211),(113,1527875.368),(114,3173509.526),(115,4864938.737),(116,4703262.211),(117,7129892.474),(118,4453.026),(119,1126976.632),(120,2506898.211),(121,126944.053),(122,145653.789),(123,159631.053),(124,205254.474),(126,2628263.158),(129,3279611.526),(130,2185571.211),(131,2256751.684),(132,101.474),(133,3194675.526),(134,11364.421),(136,175751.211),(137,584.526),(138,2.9947726368E7),(141,230740.105),(142,73.947),(143,5787499.421),(144,1516898.526),(145,171.625),(146,2344005.526),(147,102422.474),(149,6899593.053),(150,1640376.737),(153,3313.579),(154,587103.474),(155,812.789),(156,893789.0),(157,755988.679),(158,3076507.579),(159,2.3079989474E7),(162,1254331.579),(165,2.9187640421E7),(166,329205.579),(167,7034018.556),(168,10785.895),(169,1913490.895),(170,3399175.737),(171,1.7963705E7),(173,2.5452273842E7),(174,1361004.579),(175,182510.158),(176,153306.211),(177,579.737),(178,210537.778),(179,5326.768),(181,1724023.684),(182,13941.158),(183,1.6163622421E7),(184,312950.053),(185,7.7107293684E7),(186,8188671.0),(191,1171.368),(193,3094.368),(194,2882119.526),(195,1130733.643),(197,589021.053),(198,515771.053),(199,3235594.333),(201,296587.947),(202,1.2021878632E7),(203,1.9489859053E7),(205,2334.368),(206,4750939.105),(207,199753.368),(208,670475.579),(209,88720.0),(210,5100057.895),(211,1119745.684),(212,5066440.263),(213,1990981.316),(215,5087763.684),(216,3.1150354684E7),(217,774324.316),(220,11095.816),(221,14565.316),(222,1643968.368),(223,3.1094414263E7),(225,437.263),(226,2352988.474),(229,2.1769284316E7),(230,3.4156837158E7),(231,3.49967510211E8),(233,3019122.684),(234,2270303.737),(235,4878998.579),(236,2959921.316),(237,3.4303103579E7),(238,1.0015277056E7),(249,722693.684),(250,1546681.053),(251,1341342.895),(255,2782221.727),(256,165919.091),(272,8363163.4),(273,14724.2),(299,47650.0),(351,4.33514459E8)]&legendtitle=tonnes&mu=tonnes&colorramp=Blues&intervals=8&classification=equalarea&decimalnumbers=0&lang=e&renderto=map212&jointype=point',
                     url: 'http://localhost:8080/maps/api?out=join&layers=gaul0_faostat_3857&styles=join&joinboundary=FAOSTAT&enablejoingfi=true&joindata=[(1,326177.242),(2,3879424.421),(3,558745.842),(4,2907058.684),(7,626707.263),(8,63.526),(9,3.3887636632E7),(10,3.0836252632E7),(11,4854629.474),(12,359.105),(14,581.263),(15,2351409.875),(16,3.7433493632E7),(18,148115.053),(19,1401834.0),(20,40200.684),(21,5.5580661053E7),(23,55240.368),(25,2333.105),(26,639.105),(27,5734233.263),(28,2.4249129947E7),(29,279688.105),(32,1665080.789),(33,4.9452055263E7),(35,10676.368),(37,176496.263),(38,2999787.579),(39,1387452.316),(40,3102757.342),(44,3915914.632),(45,22961.526),(46,16621.579),(48,238714.316),(49,738111.316),(50,105167.316),(51,1.0197892E7),(52,1654203.316),(53,973346.842),(54,8886018.789),(55,225.474),(56,629513.477),(57,6013286.158),(58,2086055.263),(59,1.9233191053E7),(60,863322.737),(62,5034885.0),(63,644858.421),(66,15886.895),(67,3602510.526),(68,6.2986557E7),(69,21080.316),(72,10.895),(73,548516.842),(74,30912.632),(75,172405.105),(79,4.3487323368E7),(80,1132106.684),(81,1890353.684),(84,4849434.158),(86,346.0),(88,30.421),(89,1301484.105),(90,1897850.263),(91,485457.421),(93,437159.263),(95,646502.053),(97,1.2468378158E7),(98,2992673.263),(100,2.32463710526E8),(101,6.4094251053E7),(102,1.8231554737E7),(103,2894529.263),(104,2030628.842),(105,250737.895),(106,2.0224823158E7),(107,1329017.0),(108,1.5281391E7),(109,2575.637),(110,1.2269366842E7),(112,82415.211),(113,1527875.368),(114,3173509.526),(115,4864938.737),(116,4703262.211),(117,7129892.474),(118,4453.026),(119,1126976.632),(120,2506898.211),(121,126944.053),(122,145653.789),(123,159631.053),(124,205254.474),(126,2628263.158),(129,3279611.526),(130,2185571.211),(131,2256751.684),(132,101.474),(133,3194675.526),(134,11364.421),(136,175751.211),(137,584.526),(138,2.9947726368E7),(141,230740.105),(142,73.947),(143,5787499.421),(144,1516898.526),(145,171.625),(146,2344005.526),(147,102422.474),(149,6899593.053),(150,1640376.737),(153,3313.579),(154,587103.474),(155,812.789),(156,893789.0),(157,755988.679),(158,3076507.579),(159,2.3079989474E7),(162,1254331.579),(165,2.9187640421E7),(166,329205.579),(167,7034018.556),(168,10785.895),(169,1913490.895),(170,3399175.737),(171,1.7963705E7),(173,2.5452273842E7),(174,1361004.579),(175,182510.158),(176,153306.211),(177,579.737),(178,210537.778),(179,5326.768),(181,1724023.684),(182,13941.158),(183,1.6163622421E7),(184,312950.053),(185,7.7107293684E7),(186,8188671.0),(191,1171.368),(193,3094.368),(194,2882119.526),(195,1130733.643),(197,589021.053),(198,515771.053),(199,3235594.333),(201,296587.947),(202,1.2021878632E7),(203,1.9489859053E7),(205,2334.368),(206,4750939.105),(207,199753.368),(208,670475.579),(209,88720.0),(210,5100057.895),(211,1119745.684),(212,5066440.263),(213,1990981.316),(215,5087763.684),(216,3.1150354684E7),(217,774324.316),(220,11095.816),(221,14565.316),(222,1643968.368),(223,3.1094414263E7),(225,437.263),(226,2352988.474),(229,2.1769284316E7),(230,3.4156837158E7),(231,3.49967510211E8),(233,3019122.684),(234,2270303.737),(235,4878998.579),(236,2959921.316),(237,3.4303103579E7),(238,1.0015277056E7),(249,722693.684),(250,1546681.053),(251,1341342.895),(255,2782221.727),(256,165919.091),(272,8363163.4),(273,14724.2),(299,47650.0),(351,4.33514459E8)]&legendtitle=tonnes&mu=tonnes&colorramp=Blues&intervals=8&classification=equalarea&decimalnumbers=0',
                     success : function(response) {
                         var layer = eval( response);
//                         layer.addTo(map);
                         control_map.addOverlay(layer.addTo(map), "Joined Layer")

                         control_map.addOverlay(gaul0_line.addTo(map), "Boundaries")

                         map.on('moveend', function(e) {
                             map2.setView(map.getCenter(), map.getZoom());
                         });
                     },
                     error : function(err,b,c) {alert(err.status + ", " + b + ", " + c);}
                });
        },
        error : function(err,b,c) {
            alert(err.status + ", " + b + ", " + c);
        }
    });

    // AJAX call to the map service
    $.ajax({
        type: 'GET',
        // url: 'http://localhost:8080/maps/api?out=js',
        url: 'http://localhost:8080/maps/api?out=js&baselayers=osm,mapquest&renderTo=map2',
        success : function(response) {
            //console.log(response);
            // response = response.substring(3, response.length -1);
           // eval( response);

            $.ajax({
                type: 'GET',
                //url: 'http://fenix.fao.org/maps/api?out=js&baselayers=osm&layers=gaul0_faostat_3857,gaul0_line_3857&styles=join,gaul0_line&joinboundary=FAOSTAT&enablejoingfi=true&joindata=[(1,326177.242),(2,3879424.421),(3,558745.842),(4,2907058.684),(7,626707.263),(8,63.526),(9,3.3887636632E7),(10,3.0836252632E7),(11,4854629.474),(12,359.105),(14,581.263),(15,2351409.875),(16,3.7433493632E7),(18,148115.053),(19,1401834.0),(20,40200.684),(21,5.5580661053E7),(23,55240.368),(25,2333.105),(26,639.105),(27,5734233.263),(28,2.4249129947E7),(29,279688.105),(32,1665080.789),(33,4.9452055263E7),(35,10676.368),(37,176496.263),(38,2999787.579),(39,1387452.316),(40,3102757.342),(44,3915914.632),(45,22961.526),(46,16621.579),(48,238714.316),(49,738111.316),(50,105167.316),(51,1.0197892E7),(52,1654203.316),(53,973346.842),(54,8886018.789),(55,225.474),(56,629513.477),(57,6013286.158),(58,2086055.263),(59,1.9233191053E7),(60,863322.737),(62,5034885.0),(63,644858.421),(66,15886.895),(67,3602510.526),(68,6.2986557E7),(69,21080.316),(72,10.895),(73,548516.842),(74,30912.632),(75,172405.105),(79,4.3487323368E7),(80,1132106.684),(81,1890353.684),(84,4849434.158),(86,346.0),(88,30.421),(89,1301484.105),(90,1897850.263),(91,485457.421),(93,437159.263),(95,646502.053),(97,1.2468378158E7),(98,2992673.263),(100,2.32463710526E8),(101,6.4094251053E7),(102,1.8231554737E7),(103,2894529.263),(104,2030628.842),(105,250737.895),(106,2.0224823158E7),(107,1329017.0),(108,1.5281391E7),(109,2575.637),(110,1.2269366842E7),(112,82415.211),(113,1527875.368),(114,3173509.526),(115,4864938.737),(116,4703262.211),(117,7129892.474),(118,4453.026),(119,1126976.632),(120,2506898.211),(121,126944.053),(122,145653.789),(123,159631.053),(124,205254.474),(126,2628263.158),(129,3279611.526),(130,2185571.211),(131,2256751.684),(132,101.474),(133,3194675.526),(134,11364.421),(136,175751.211),(137,584.526),(138,2.9947726368E7),(141,230740.105),(142,73.947),(143,5787499.421),(144,1516898.526),(145,171.625),(146,2344005.526),(147,102422.474),(149,6899593.053),(150,1640376.737),(153,3313.579),(154,587103.474),(155,812.789),(156,893789.0),(157,755988.679),(158,3076507.579),(159,2.3079989474E7),(162,1254331.579),(165,2.9187640421E7),(166,329205.579),(167,7034018.556),(168,10785.895),(169,1913490.895),(170,3399175.737),(171,1.7963705E7),(173,2.5452273842E7),(174,1361004.579),(175,182510.158),(176,153306.211),(177,579.737),(178,210537.778),(179,5326.768),(181,1724023.684),(182,13941.158),(183,1.6163622421E7),(184,312950.053),(185,7.7107293684E7),(186,8188671.0),(191,1171.368),(193,3094.368),(194,2882119.526),(195,1130733.643),(197,589021.053),(198,515771.053),(199,3235594.333),(201,296587.947),(202,1.2021878632E7),(203,1.9489859053E7),(205,2334.368),(206,4750939.105),(207,199753.368),(208,670475.579),(209,88720.0),(210,5100057.895),(211,1119745.684),(212,5066440.263),(213,1990981.316),(215,5087763.684),(216,3.1150354684E7),(217,774324.316),(220,11095.816),(221,14565.316),(222,1643968.368),(223,3.1094414263E7),(225,437.263),(226,2352988.474),(229,2.1769284316E7),(230,3.4156837158E7),(231,3.49967510211E8),(233,3019122.684),(234,2270303.737),(235,4878998.579),(236,2959921.316),(237,3.4303103579E7),(238,1.0015277056E7),(249,722693.684),(250,1546681.053),(251,1341342.895),(255,2782221.727),(256,165919.091),(272,8363163.4),(273,14724.2),(299,47650.0),(351,4.33514459E8)]&legendtitle=tonnes&mu=tonnes&colorramp=Blues&intervals=8&classification=equalarea&decimalnumbers=0&lang=e&renderto=map212&jointype=point',
                url: 'http://localhost:8080/maps/api?out=join&layers=gaul0_faostat_3857&styles=join&joinboundary=FAOSTAT&enablejoingfi=true&joindata=[(1,326177.242),(2,3879424.421),(3,558745.842),(4,2907058.684),(7,626707.263),(8,63.526),(9,3.3887636632E7),(10,3.0836252632E7),(11,4854629.474),(12,359.105),(14,581.263),(15,2351409.875),(16,3.7433493632E7),(18,148115.053),(19,1401834.0),(20,40200.684),(21,5.5580661053E7),(23,55240.368),(25,2333.105),(26,639.105),(27,5734233.263),(28,2.4249129947E7),(29,279688.105),(32,1665080.789),(33,4.9452055263E7),(35,10676.368),(37,176496.263),(38,2999787.579),(39,1387452.316),(40,3102757.342),(44,3915914.632),(45,22961.526),(46,16621.579),(48,238714.316),(49,738111.316),(50,105167.316),(51,1.0197892E7),(52,1654203.316),(53,973346.842),(54,8886018.789),(55,225.474),(56,629513.477),(57,6013286.158),(58,2086055.263),(59,1.9233191053E7),(60,863322.737),(62,5034885.0),(63,644858.421),(66,15886.895),(67,3602510.526),(68,6.2986557E7),(69,21080.316),(72,10.895),(73,548516.842),(74,30912.632),(75,172405.105),(79,4.3487323368E7),(80,1132106.684),(81,1890353.684),(84,4849434.158),(86,346.0),(88,30.421),(89,1301484.105),(90,1897850.263),(91,485457.421),(93,437159.263),(95,646502.053),(97,1.2468378158E7),(98,2992673.263),(100,2.32463710526E8),(101,6.4094251053E7),(102,1.8231554737E7),(103,2894529.263),(104,2030628.842),(105,250737.895),(106,2.0224823158E7),(107,1329017.0),(108,1.5281391E7),(109,2575.637),(110,1.2269366842E7),(112,82415.211),(113,1527875.368),(114,3173509.526),(115,4864938.737),(116,4703262.211),(117,7129892.474),(118,4453.026),(119,1126976.632),(120,2506898.211),(121,126944.053),(122,145653.789),(123,159631.053),(124,205254.474),(126,2628263.158),(129,3279611.526),(130,2185571.211),(131,2256751.684),(132,101.474),(133,3194675.526),(134,11364.421),(136,175751.211),(137,584.526),(138,2.9947726368E7),(141,230740.105),(142,73.947),(143,5787499.421),(144,1516898.526),(145,171.625),(146,2344005.526),(147,102422.474),(149,6899593.053),(150,1640376.737),(153,3313.579),(154,587103.474),(155,812.789),(156,893789.0),(157,755988.679),(158,3076507.579),(159,2.3079989474E7),(162,1254331.579),(165,2.9187640421E7),(166,329205.579),(167,7034018.556),(168,10785.895),(169,1913490.895),(170,3399175.737),(171,1.7963705E7),(173,2.5452273842E7),(174,1361004.579),(175,182510.158),(176,153306.211),(177,579.737),(178,210537.778),(179,5326.768),(181,1724023.684),(182,13941.158),(183,1.6163622421E7),(184,312950.053),(185,7.7107293684E7),(186,8188671.0),(191,1171.368),(193,3094.368),(194,2882119.526),(195,1130733.643),(197,589021.053),(198,515771.053),(199,3235594.333),(201,296587.947),(202,1.2021878632E7),(203,1.9489859053E7),(205,2334.368),(206,4750939.105),(207,199753.368),(208,670475.579),(209,88720.0),(210,5100057.895),(211,1119745.684),(212,5066440.263),(213,1990981.316),(215,5087763.684),(216,3.1150354684E7),(217,774324.316),(220,11095.816),(221,14565.316),(222,1643968.368),(223,3.1094414263E7),(225,437.263),(226,2352988.474),(229,2.1769284316E7),(230,3.4156837158E7),(231,3.49967510211E8),(233,3019122.684),(234,2270303.737),(235,4878998.579),(236,2959921.316),(237,3.4303103579E7),(238,1.0015277056E7),(249,722693.684),(250,1546681.053),(251,1341342.895),(255,2782221.727),(256,165919.091),(272,8363163.4),(273,14724.2),(299,47650.0),(351,4.33514459E8)]&legendtitle=tonnes&mu=tonnes&colorramp=Blues&intervals=8&classification=equalarea&decimalnumbers=0',
                success : function(response) {
                    var layer = eval( response);
//                         layer.addTo(map);
                    control_map2.addOverlay(layer.addTo(map2), "Joined Layer2")

                    control_map2.addOverlay(gaul0_line2.addTo(map2), "Boundaries2")
                },
                error : function(err,b,c) {alert(err.status + ", " + b + ", " + c);}
            });
        },
        error : function(err,b,c) {
            alert(err.status + ", " + b + ", " + c);
        }
    });
	
}
</script>

</head>


<body onload='test();'>	


    <div class=''>
        <div id="map"></div>
        <div id="map2"></div>
    </div>

</body>
</html>

